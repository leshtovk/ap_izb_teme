setwd(~/repos/itap/vaje_islr)
setwd("~/repos/itap/vaje_islr/linear_regression")
getwd()
# multiple linear regression
fix(Boston)
library(MASS)
fix(Boston)
?Boston
View(Boston)
rm(list = objects())
View(Boston)
fix(Boston)
attach(Boston)
# Train a multiple linear regression model
lm.fit <- lm(medv ~ lstat + age, data = Boston)
summary(lm.fit)
source('~/repos/itap/vaje_islr/linear_regression/simple.R')
summary(lm.fit)
rm(list = objects())
lm.fit = lm(medv ~ lstat + age)
summary(lm.fit)
plot(age, meanv)
plot(age, meadv)
plot(age, medv)
par(mfrow = c(1, 1))
plot(age, medv)
mean(medv)
?abline
plot(age, medv)
m <- mean(medv)
abline(m, 0, col = "red")
abline(m, 0, col = "red", lwd = 3)
med <- median(medv)
abline(med, 0, col = "green", lwd = 3)
persp(lm.fit)
?persp
plot(age, medv)
coef(lm.fit)
c(b0, b1, b2) <- coef(lm.fit)
cf <- coef(lm.fit)
b0 <- cf[1]
b1 <- cf[2]
b2 <- cf[3]
f <. function(x) b0 + (b1 * x) + (b2 * x)
f <- function(x) b0 + (b1 * x) + (b2 * x)
y <- seq(0, 100, length=100)
plot(medv, lstat)
x <- seq(0, 50, length = 100)
Z <- outer(x, y, f(x, y))
f <- function(x, y) b0 + (b1 * x) + (b2 * y)
Z <- outer(x, y, f(x, y))
Z <- outer(x, y, f)
persp(x, y, Z)
persp(x, y, Z, theta = 45)
file.edit("multiple.R")
dev.off()
par(mfrow = c(1, 2))
source("multiple.R")
source("multiple.R")
hist(age)
dev.off()
par(mfrow = c(1, 3))
source("multiple.R")
source("multiple.R")
source("multiple.R")
rm(list = objects())
fix(Boston)
attach(Boston)
View(Boston)
crime
attach(Boston)
age
lstat
crime
head(Boston)
crim
lm.fit <- lm(medv ~., data = Boston)
summary(lm.fit)
lm.fit <- update(lm.fit, ~.-indus-age)
summmary(lm.fit)
summary(lm.fit)
lm.fit <- lm(medv ~ lstat*age, data = Boston)
summary(lm.fit)
lm.fit1 <- lm(medv ~ lstat*age, data = Boston)
lm.fit2 <- lm(medv ~ lstat + I(lstat^2))
summary(lm.fit2)
range(lstat)
x <- seq(from = 0, to = 50, length = 1000)
coefs <- coef(lm.fit2)
b0 <- coefs[1]
b1 <- coefs[2]
b2 <- coefs[3]
f <- function(x) b0 + (b1 * x) + (b2 * x)
par(mfrow = c(1, 1))
plot(x, f(x))
anova(lm.fit1, lm.fit2)
lm.fit1
lm.fit1 <- lm(medv ~. -age, data = Boston)
anova(lm.fit1, lm.fit2)
lm.fit1 <- lm(medv ~ lstat, data = Boston)
anova(lm.fit1, lm.fit2)
summary(lm.fit2)
file.edit("multiple.R")
file.edit("compare.R")
?plot
rm(list = objects(O))
rm(list = objects())
fix(Boston)
source("compare.R")
anova(lm.fit1, lm.fit2)
par(mfrow = c(2, 2))
plot(lm.fit1)
plot(lm.fit2)
seq(1, 100)
file.edit("compare.R")
rm(list = objects())
objects()
library(ISLR)
dev.off()
fix(Carseats)
str(Carseats)
head(Carseats)
attach(Carseats)
lm.fit <- lm(Sales ~. + Income:Advertising + Price:Age,
data = Carseats)
summary(lm.fit)
contrasts(ShelveLoc)
{}
f <- function {}
f <- function {
rm(list = objects())
library(ILSR)
library(ISLR)
fix(Auto)
attach(Auto)
plot(horsepower, mpg)
lm.fit <- lm(mpg ~ horsepower, data = Auto)
summary(lm.fit)
abline(lm.fit)
abline(lm.fit, lwd = 3, col = "red")
lm.res <- residuals(lm.fit)
lm.pred(lm.fit)
lm.pred <- predict(lm.fit)
plot(lm.pred, lm.res)
plot(horsepower, mpg)
abline(lm.fit, lwd = 3, col = "red")
plot(lm.pred, lm.res)
?predict
file.edit("simple.R")
predict(lm.fit, data.frame(horsepower = c(98)),
interval = "confidence", level = 0.95)
plot(lm.pred, lm.res)
plot(horsepower, mpg)
yp <- predict(lm.fit, data.frame(horsepower = c(98)),
interval = "confidence", level = 0.95)
rp <- residuals(lm.fit, data.frame(horsepowe = c(98)))
lines(98, yp, col = "green")
lines(98, yp[1], col = "green")
lines(98, yp[1], lwd = 3, col = "green")
points(98, yp[1], col = "green")
points(98, yp[1], col = "green", pch = 19)
lines(lm.fit)
abline(lm.fit)
abline(lm.fit, col = "red", lwd = 3)
par(new=TRUE)
plot(lm.pred, lm.res)
dev.off()
plot(lm.pred, lm.res)
dev.off()
plot(horsepower, mpg)
points(98, yp[1], col = "red", pch = 19)
abline(lm.fit, lwd = 3, col = "blue")
predict(lm.fit, data.frame(horsepower = c(98)),
interval = "confidence", level = 0.95)
str(Auto)
# problem 9
str(Auto)
pairs(Auto)
seq(1, 100, by=1)
head(Auto)
?corresp
?cor
Auto.dim <- dim(Auto.dim)
Auto.dim <- dim(Auto)
cor(Auto[-dim[2]])
Auto.num <- Auto[-dim[2]]
Auto.num <- Auto[-Auto.dim[2]]
str(Auto.num)
cor(Auto.num)
str(Auto)
Auto.cor <- cor(Auto.num)
lm.fit <- lm(mpg ~., data = Auto.num)
summary(ln.fit)
summary(lm.fit)
Auto.cor
pairs(Auto.num)
lm.res <- residuals(lm.fit)
lm.pred <- predict(lm.fit)
plot(lm.pred, lm.res)
file.edit("problems.R")
outlierTest(lm.fit)
?hatvalues
hatvalues(lm.fit)
lm.lev <- hatvalues(lm.fit)
plot(lm.pred, lm.lev)
pairs(Auto.num)
lm.fit1 <- lm(mpg ~ horsepower + sqrt(horsepower), data = Auto.num)
plot(horsepower, mpg)
abline(lm.fit1)
summary(lm.fit1)
lm.pred1 <- predict(lm.fit1)
lm.res1 <- residuals(lm.fit1)
plot(lm.pred1, lm.fit1)
plot(lm.pred1, lm.res1)
lm.fit1 <- lm(log(mpg) ~ horsepower + sqrt(horsepower), data = Auto.num)
lm.pred1 <- predict(lm.fit1)
lm.res1 <- residuals(lm.fit1)
summary(lm.fit1)
plot(lm.pred1, lm.res1)
abline(median(lm.res1), lwd = 3, col = "red")
abline(median(lm.res1), 0, lwd = 3, col = "red")
abline(mean(lm.res1), 0, lwd = 3, col = "red")
abline(median(lm.res1), 0, lwd = 3, col = "red")
lm.lev1 <- hatvalues(lm.fit1)
plot(lm.pred1, lm.lev1)
plot(horsepower, mpg)
abline(lm.fit1)
abline(lm.fit1, lwd = 3, col = "red")
x <- seq(0, 300)
lm.coef1 <- coefficients(lm.fit1)
summary(lm.fit1)
f <- funcion(x1, x2) {
lm.coef1[1] + lm.coef1[2] * x1 + lm.coef1[3] * x2
}
f <- function(x1, x2) {
lm.coef1[1] + lm.coef1[2] * x1 + lm.coef1[3] * x2
}
Z <- outer(x, x, f)
persp(x, x, Z)
persp(x, x, Z, theta = 45)
